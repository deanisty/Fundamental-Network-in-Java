# 前言

鲜有文档或文献着重描述Java语言与它所处平台之间交互，本书致力于填补这部分空白，站在Java API的角度介绍了网络的基础原理并且深入了TCP/IP和UDP网络的方方面面，此外还探讨了网络高级编程技术。JDK1.4引入了新的I/O模型和网络特性，恰好也进一步印证了本书出现的合理性。正如我贯篇强调的那样，本书中所描述的许多内容在其他相关的Java文档或书籍中或未提及或有失准确性。

在编写本书时，本人已有近20年的网络编程经验，涉及到大量不同的网络协议，API和编程语言，基于很多不同的平台(许多现在已经消失了)，网络的规模从一个几英寸长的以太网，到相隔数英里的跨城企业WAN，到地域分布非常广的因特网。

本书涵盖了“传统的”Java流式I/O以及基于buffer和channel的"NIO(new I/O)"，包括NIO的非阻塞和多路复用特性分别对于普通类型的socket和安全socket的支持，同时也包含了非阻塞的TLS/SSL和GSS-API。

本书站在可扩展性尤其是性能分析的角度同时讨论了使用阻塞I/O模式和非阻塞I/O模式的服务器和客户端架构。

本书的最后附录了一个Java语言调用TCP/IP API在不同平台的差异列表，还提供了一个方便的参考列表可以通过端口号识别socket不同状态。

## 关于本书

### 受众
本书假设读者已经具备了Java编程语言基础知识，尤其是类，对象，方法，接口，参数，变量，返回值和异常等概念，熟悉面向对象编程的基本原则：继承和多态，熟悉标准Java I/O，工具和异常类。

本书同样假设读者有能力理解短篇幅的Java示例代码片段而不需要逐行解释，有能力脱离示例代码用Java语言实现简单重复的功能。同样希望读者具备基础的TCP客户端和服务端编程知识，尽管书中提供了一个简单的示例。最后，希望读者了解互联网，主机和路由器，而且有动力去查阅相关资料。

书中使用了一些比较标准化的设计模式相关词汇，尤其是适配器，代理，门面，工厂等，这些概念首次出现在Addison-Wesley1995年出版的，Gamma等人编著的《设计模式：可复用面向对象软件》一书中，现在已经普遍使用，不需要过多的解释。书中同样使用了没有定义的注释的UML序列图，它本身已经很容易理解。

### 涉及内容
本书自顶向下描述了TCP相关的知识，从Java API到socket选项和buffer，到TCP报文段级别，包含建立连接和断开连接过程，RST报文，稍微扩展了窗口相关的知识，但是不包含序列号生成，速率调整，确认和重试。

同样也自顶向下描述了UDP，从Java API到socket选项和buffer，到UDP数据报级别，包含单播，广播和多播，也包含了可靠UDP的知识，擦除代码，和更高级别的多播协议。

作者尤其重视对多宿主主机的忽略和广泛的误解，特别是涉及到UDP单播，广播和多播时，多宿主主机会带来新的困难。

书中通过传统的Java流式I/O和基于buffer-channel的NIO分别对TCP，UDP和TLS/SSL协议的阻塞模式和非阻塞模式进行了描述。对基于TLS和SSL的安全socket进行了详细讲解，而JGSS-API作为备选方案进行了讨论。

书中使用了完整的章节将JDK1.5的SSLEngine付诸实践，并且提供了完整且正确的 SSLEngineManager 示例代码，使用它可以编写非阻塞的SSL服务器和客户端代码。

1.2小节描述了本书的组织结构。


### 未涉及内容
本书不包括IP数据包相关的所有内容，也不包括ICMP，ARP，RARP，DHCP等协议相关的内容，但在讨论多播时出现了IGMP协议的身影。这些内容在Stevens和Wright所著,Addison-Wesley 1995年出版的《TCP/IP详解》第一卷和第二卷中有相当全面的描述，其权威性和完备性无需赘述。

本书未曾提及OSI-7层网络模型，因为它已经被弃之不用，而且TCP/IP也不必强行与之对应。

本书不包括所有的上层协议比如HTTP，HTTPS和FTP。也不包括任何对J2EE的描述，Java RMI（Remote Method Invocation）虽未涉及但是却描述了RMI socket构造工厂的使用，因为它不但缺少文档而且有些难以掌握。Kathleen McNiff和我在Addison-Wesley 2001年出版的 《Java rmi: The Guide to Remote Method Invocation》一书中描述了Java RMI相关知识。

尽管在第12章中的“服务端和客户端模式“中确实存在设计模式，但是我依然毫不犹豫的反对近来将计算机科学的发展重新归结为设计模式的观点。正是因为Java语言的某些部分和Java类库由设计模式构成，因此才将很多现存的设计模式引入了网络编程。

本书的主题和示例代码都是针对网络编程。因此和网络编程无关的Java代码不会出现在本书中。没有一行与AWT或者Swing相关的代码，没有屏幕快照，控制台输出，流媒体试听或者3D动画。同样的，与主题相关性有限的程序也不会提供完整的源代码。

### 致谢
首先要感谢众多花费数十年研究和开发了TCP/IP协议的人，IETF正式标准和RFC记载了这些协议的内容和研发人员的名单，还有其它一些被列在参考文献中。

任何一个严肃的TCP和UDP书籍的作者都应该把一切功劳归功于晚年的W.Richard Stevens，我有幸与他通过几封邮件。Stevens在他的《TCP/IP详解》第三卷中讲解了整个协议相关的内容，包括官方定义和BSD 4.4的具体实现，同时在他的《Unix网络编程》卷2中详细讲解了伯克利socket API所有细节。这两本书已经成为现今IP网络编程的基础参考文献，无论是使用任何编程语言。

本书初次出版于1993年时只有仅仅25页，由我和我的兄弟以及同事David Pitt所写。起初只是在雇员和客户之间私下传阅，但后来令人意想不到的散布到了许多地方。

有些匿名读者对本书最终的格式和内容做出了巨大的贡献。如果书中内容描述有误，那必然是我的错。

非常感谢 Sun Microsystems公司无偿提供了Java给我使用，同时也感谢 Sun Microsystem公司的 Melbourne 和 Australia为我提供了 Solaris系统和Linux测试工具。

同时感谢我的同事 Neil Belford长期给我建议，帮助和鼓励。最后，感谢 Tilly Stoové和所有 Pitt的家人在本书写作过程中的理解与支持。

> Esmond Pitt,墨尔本，2005.6
